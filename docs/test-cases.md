# Типовой сценарий тестирования

После завершения работ по интеграции необходимо провести ряд тестов. Отчет с результатами тестов необходимо отправить по почте лицу, с которым вы общались по вопросу интеграции.

При проведении каждого теста убедитесь что зафиксировано точное время проведения каждого теста (чтобы можно было сопоставить с данными из логов тестсервера) - например дату и время может быть видно на скринштах в области уведомлений Windows. 

Пожалуйста, не забудьте указать ваш часовой пояс.

Все тесты следует выполнять [на тестовом сервере](/test-server.md).


### 1. Использование недействительной карты

Добавьте в чек карту `1234567890055` и какие-либо товары и попробуйте расчитать скидку.

Сервер ответит ошибкой про некорректный (неизвестный) номер карты.

Сделайте скриншот, как это сообщение отображается на экране кассы.


### 2. Расчет скидки по одной позиции

Добавьте в чек карту `1234567890050` и препарат `1111111111116` и попробуйте рассчитать скидку.

Скидка должна рассчитаться.

Сделайте скриншот, как информация о наличии и размере скидки отображается на экране кассы.


### 3. Расчет скидки по нескольким позициям

Добавьте в чек карту `1234567890050` и три препарата: `1111111111116`, `2222222222222` и произвольный третий (не `3333333333338`) и попробуйте рассчитать скидку.

Скидка должна рассчитаться на два препарата, а на третий будет сообщение что препарат не входит в программу.

Сделайте скриншот, как информация о наличии и размере скидки отображается на экране кассы.


### 4. Нарушение условий для предоставления скидки

Добавьте в чек карту `1234567890050` и препарат `3333333333338` с ценой более 1000 рублей, и попробуйте рассчитать скидку.

Скидка НЕ будет рассчитана, при этом вернется сообщение что на препарат нет скидки так как его цена выше разрешенной.

Сделайте скриншот, как это сообщение отображается на экране кассы.


### 5. Подтверждение чека

Добавьте в чек карту `1234567890050` и два препарата: `1111111111116` в количестве 2, `2222222222222` в количестве 3 и попробуйте рассчитать скидку.

Скидка должна рассчитаться на оба препарата.

Зафиксируйте продажу (как будто пробился чек).

Предоставьте информацию о дате и времени выполнения этого теста (вызова confirm_purchase).


### 6. Отмена продажи

Если в вашем кассовом ПО не разрешено отменять продажи (делать возвраты), то напишите это в результатах данного теста, и сам тест выполнять не надо.

Добавьте в чек карту `1234567890050` и препарат `1111111111116` в количестве 6 и попробуйте рассчитать скидку.

Должна рассчитаться скидка.

Зафиксируйте продажу (как будто пробился чек).

Отмените продажу.

Предоставьте информацию о дате и времени выполнения этого теста (вызова cancel_purchase).


### 7. Неудачное подтверждение

Опишите, какова будет реакция вашего кассового ПО (что увидит провизор, что произойдет на кассе), если вызов ``confirm_purchase` закончится неуспешно:

1. Если сервер упадет с 500-й ошибкой
2. Если сервер вернет ответ с status=fail и ненулевым error_code


### 8. Частичное подтверждение

Опишите, возможна ли ситуация когда вызов `confirm_purchase` будет содержать не все коды `transaction` из ответа `get_discount` (может ли например провизор удалить позицию из чека после расчета скидки)?


### 9. Список аптек

Отправьте на сервер информацию по аптекам (`pl` или `update_pharmacies`).

1. Предоставьте информацию о дате и времени выполнения этого теста.
2. Опишите, каким образом будет настроено автоматическое регулярное предоставление этой информации?


### 10. Информационные методы

Напишите, делаете ли вы вызовы `get_products` и `get_programs`, и если да - то как используются возвращаемые ими данные?


### 11. Обновление прайс-листа

Отправьте на сервер информацию по остаткам и ценам методом `update_prices`.

1. Предоставьте информацию о дате и времени выполнения этого теста.
2. Опишите:
    * каким образом будет настроено автоматическое регулярное предоставление этой информации?
    * Кем управляется перечень отправляемых товаров - программистом (прошито в коде), администратором АС (задается в настройках системы), автоматически по результатам `get_products` или иным способом?


### 12. Информация о продажах без скидки

Отправьте на сервер информацию по остаткам и ценам методом `sellout`.

1. Предоставьте информацию о дате и времени выполнения этого теста.
2. Опишите:
    * каким образом будет настроено автоматическое регулярное предоставление этой информации? 
    * Кем управляется перечень отправляемых товаров - программистом (прошито в коде), администратором АС (задается в настройках системы), автоматически по результатам `get_products` или иным способом?

----------

Если вы можете провести какие-то еще "интересные" тесты - проводите их и опишите в отчете.

Отчет необходимо прислать на почту тому лицу, с кем вы взаимодействовали по вопросам интеграции.
