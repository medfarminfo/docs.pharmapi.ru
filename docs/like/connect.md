# Подключение к серверу

В начале интеграции каждому партнеру выделяется специализированное имя сервера (`hostname`), а также тестовые значения параметров `authorization-token` и `authorization-secret`.

После окончания интеграции, для доступа в боевую среду, имя сервера останется тем же, а `authorization-token` и `authorization-secret` будут предоставлены новые.

Таким образом, переключение между "тестовой" и "боевой" средой выполняется по значениям параметров доступа. При этом [тестовый сервер имеет собственные настройки дисконтной программы](test-server.md) (префиксы карт и коды товаров), что минимизирует риск отправки запроса "не туда" в случае путаницы конфигурационных файлов на стороне аптеки.

!> Обмен данными следует выполнять по hostname, так как IP может меняться со временем.


## HTTPS

Обмен данными возможен только по протоколу HTTPS (обычный HTTP не поддерживается).


## UrlEncode

Каждый сервер имеет два endpoint-а для обмена данными: 

 * `https://{hostname}/api/{api_version}/` - запросы и ответы передаются в теле запроса в JSON
 * `https://{hostname}/api/{api_version}-encoded/` - запросы и ответы передаются в теле запроса в JSON, кодированном с помощью urlencode 

Использовать можно любой из двух endpoint-ов.


## Версии API (api_version) :id=api-versions

Сервер может одновременно работать с разными версиями API.

Различия между версиями описаны ниже, выберите удобную вам версию протокола.

### v1.1  :id=api-version-1-1

Отличается от v1.0 множественным числом в имени поля (`programs` вместо `program`) в ответе на запрос `get_programs` ([подробнее здесь](changes.md#programs-in-get-programs)).

Для доступа используйте endpoint-ы `https://{hostname}/api/v1.1/` и `https://{hostname}/api/v1.1-encoded/`.

### v1.0  :id=api-version-1-0

Первоначальная версия.

Для доступа используйте endpoint-ы `https://{hostname}/api/v1.0/` и `https://{hostname}/api/v1.0-encoded/`.